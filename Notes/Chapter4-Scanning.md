# Chapter 4 Scanning

> 在匹配标识符时，保持  maximal match  原则，就是当有两个标识符同时匹配当前字段时，选择匹配最长的那个token  类型。

第一次成功执行自己的  scanner，里程碑的第一步。
```Python
(base) lkx@SEUdeiMac-Pro myPyLox % python PyLox.py
>>> var name = "lkx"
Token: var      Token Type: VAR         
Token: name     Token Type: IDENTIFIER  
Token: =        Token Type: EQUAL       
Token: "lkx"    Token Type: STRING      
Token: EOF      Token Type: EOF    
```

## Scanner 过程：
Scanner 是一个 Token  扫描器，输入是代码源文件，输出是一个  Token  构成的列表。
对于一个代码文件来说，Scanner读取所有的字符，然后形成 Token Type，一个 Token 可以包含：
1. token 类型
2. token 的原生字符串值
3. object  类型（我不知道这个  object  用于做什么）
4. 行数，每一个 token 有一个行数，所以当扫描时发现语法错误时，就可以给出行号的错误信息（如果是一门真实的语言，那么还需要精确到哪一个 token 的位置）

对于一个源代码文件来说，有很多种 token 类型，所以需要先定义类型，然后一个一个，像捡鸡蛋一个捡起类型。在扫描过程中，有一个最长匹配原则，就是如果一个字符串能够匹配两种 token 类型，那么就选择匹配到最长的那个类型。
源文件中的 token 类型有：
1. 简单短 token：左右圆括号，左右尖括号，分好，点，减号，加号，冒号，斜杠，星号
2. 可以组合的token：等号，不等号，双等号，大于，大于等于，小于，小于等于
3. 字面量：变量名，字符串，数字
4. 关键字：CLASSFORWHILETRUE等等
5. 特殊  token，EOF 文件终止符

对于简单短  token，遇到之后直接收集即可
对于可以组合的 token，扫描到一个之后，peek  一下之后的字符串，选择最长匹配的那个符号
对于字面量，需要判断是否是数字还是字符串
如果都不是，那就应该是一个标识符，也就是  identifier，先看标识符是不是保留的关键字，不是的话就是自定义的变量名。

## 如何判断一串字符是否是数字还是字符串？
这里的处理会复杂一些：
1. 当 source 以"开头时，表示此时开始一个字符串，当找到下一个"时，表示字符串结束，如果没有找到，那么报语法错误。
2. 当 source 以数字开头，只要遇到0-9，就开始一直扫描。此时如果遇到 .，表示此时是浮点数，持续收集所有遇到的数字，直到下一个不是数字。这里也可以解释为什么变量名不能以数字开头，是为了简化这里的操作。
3. 当 source  以 a-z, A-Z开头时，表示当前是一个标识符，至于是一个自定义的变量名还是保留的关键字，用关键字字典匹配一下就知道了。

当扫描时，要灵活的行动，因为不是一个一个 character 的去读，而是可能需要切割出一部分来读取，所以需要维护两个指针：start和 end，当遇到像字符串，标识符，数字这样的长 token 时，可以通过两个指针来截取部分。同时，还会需要几个函数去peek 下一个，或者下两个字符。